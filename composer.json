{
  "name": "portrino/t3cmd24",
  "require": {
    "typo3/cms-base-distribution": "^12.4",
    "typo3/cms-introduction": "^4.6",

    "b13/container": "^2.3",
    "helhum/typo3-console": "^8.1"
  },
  "require-dev": {
    "roave/security-advisories": "dev-latest"
  },
  "config": {
    "allow-plugins": {
      "typo3/class-alias-loader": true,
      "typo3/cms-composer-installers": true
    },
    "bin-dir": "bin",
    "github-protocols": [
      "https"
    ],
    "optimize-autoloader": true,
    "preferred-install": "dist",
    "secure-http": true
  },
  "extra": {
    "typo3/cms": {
      "web-dir": "public"
    }
  },
  "scripts": {
    "post-autoload-dump": [
      "[ ! -d ./public/fileadmin/ ] && ./bin/typo3 install:setup --force --no-interaction && ./bin/typo3 extension:setup || echo 'Skipping forced TYPO3 auto-installation!'",
      "[ -d ./public/fileadmin/ ] && [ $TYPO3_PENDING_UPGRADE -eq 0 ] && composer run-script post-script:typo3-console-stack || echo 'Skipping post-script:typo3-console-stack - First install?!'",
      "[ -d ./public/fileadmin/ ] && [ $TYPO3_PENDING_UPGRADE -eq 0 ] && composer run-script post-script:database-migrations || echo 'Skipping post-script:database-migrations - First install?!'"
    ],

    "post-script:database-migrations": [
      "@typo3:database-update-schema"
    ],
    "post-script:typo3-console-stack": [
      "@typo3:fix-folder-structure",
      "@typo3:flush-system-cache"
    ],

    "typo3:database-update-schema": [
      "[ -e ./bin/typo3 ] && ./bin/typo3 database:updateschema *.add,*.change || echo 'No typo3 binary found!'"
    ],
    "typo3:fix-folder-structure": [
      "[ -e ./bin/typo3 ] && ./bin/typo3 install:fixfolderstructure || echo 'No typo3 binary found!'"
    ],
    "typo3:flush-system-cache": [
      "[ -e ./bin/typo3 ] && ./bin/typo3 cache:flushtags system || echo 'No typo3 binary found!'"
    ]
  }
}
